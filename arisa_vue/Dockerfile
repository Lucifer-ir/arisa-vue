# مرحله ۱: استفاده از یک ایمج پایه Node.js
# ما از نسخه alpine استفاده می‌کنیم چون سبکه و برای توسعه عالیه
FROM node:20-alpine

# مرحله ۲: تعیین پوشه کاری داخل کانتینر
# تمام دستورات بعدی از این پوشه اجرا میشن
WORKDIR /app

# مرحله ۳: کپی کردن فایل‌های مدیریت پکیج
# این کار رو اول می‌کنیم تا از کش داکر استفاده کنیم و بیلدهای بعدی سریعتر باشن
COPY package*.json ./

# مرحله ۴: نصب وابستگی‌ها
RUN npm install --verbose

# مرحله ۵: کپی کردن بقیه فایل‌های پروژه
COPY . .

# مرحله ۶: باز کردن پورت ۵۱۷۳
# این پورتیه که Vite (سرور توسعه Vue) روش اجرا میشه
EXPOSE 5173

# مرحله ۷: دستور اجرایی برای شروع پروژه
# --host 0.0.0.0 خیلی مهمه تا سرور از خارج کانتینر در دسترس باشه
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0"]